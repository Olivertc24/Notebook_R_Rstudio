---
title: "Práctica Módulo 6: Visualización de Datos"
subtitle: "Explorando el Mercado Inmobiliario con ggplot2"
author: "Prof. Oliver Triveño"
format: 
  html:
    theme: yeti
    toc: true
    code-tools: true
    self-contained: true
editor: visual
lang: es
---

## Instrucciones

El objetivo es "pintar con datos". Usaremos `ggplot2` para encontrar patrones visuales en los precios de las casas.
**Requisito:** Asegúrate de tener el archivo `data_house_price.csv` en tu carpeta.

---

## Parte 0: Preparación del Lienzo

### Ejercicio 0.1: Carga y Limpieza
1. Carga `tidyverse`.
2. Lee `data_house_price.csv`.
3. **Importante:** La variable `condition` (estado de la casa) viene como número (1 a 5). Para graficarla bien, conviértela a **factor** usando `as.factor()`.
4. Filtra las casas con precio `0` (hay datos sucios) y quédate solo con las que cuestan más de 0.

```{r}
#| message: false
library(tidyverse)

# 1. Leer datos
casas <- read_csv("data_house_price.csv")

# 2. Limpieza (Factor y Filtro)
casas_limpias <- casas %>% 
  mutate(condition = as.factor(condition)) %>% 
  filter(price > 0)

glimpse(casas_limpias)
```

## Parte 1: Gráficos de Dispersión (Scatter Plots)

### Ejercicio 1.1: Relación Tamaño-Precio

Queremos confirmar la hipótesis: "A mayor tamaño, mayor precio".

1. Crea un gráfico con sqft_living en el eje X y price en el eje Y.

2. Usa geom_point().

3. Agrega el argumento alpha = 0.5 dentro del geom para ver mejor la densidad de puntos (transparencia).

```{r}
# Escribe tu código aquí
```

### Ejercicio 1.2: Agregando una tercera dimensión (Color)

Copia el gráfico anterior y agrega color = condition dentro de la estética aes(). ¿Las casas en mejor condición (5) tienden a estar más arriba (más caras) para el mismo tamaño?

```{r}
# Escribe tu código aquí
```

## Parte 2: Distribuciones (Histogramas y Boxplots)

### Ejercicio 2.1: El Histograma de Precios

Visualiza cómo se distribuyen los precios.

1. Usa geom_histogram().

2. Prueba con bins = 30 o bins = 50.

3. Pinta las barras de color "skyblue" (relleno).

Nota: Es normal que la distribución esté muy sesgada a la izquierda (muchas casas baratas, pocas mansiones).

```{r}
# Escribe tu código aquí
```

### Ejercicio 2.2: Boxplot por Condición

Compara los rangos de precios según la condición de la casa.

* Eje X: condition

* Eje Y: price

* Relleno (fill): condition

* Geometría: geom_boxplot()

Para ver mejor las diferencias, agrega una capa extra: scale_y_log10(). Esto pondrá el precio en escala logarítmica y reducirá el efecto de las mansiones extremas.

```{r}
# Escribe tu código aquí
```

## Parte 3: Facetas (Small Multiples)

### Ejercicio 3.1: Dividir por Habitaciones
A veces el gráfico se satura. Vamos a separar la visualización anterior por el número de pisos (floors).

1. Reutiliza tu gráfico de dispersión (Tamaño vs Precio).

2. Agrega + facet_wrap(~ floors).

3. ¿Notas alguna diferencia en la pendiente entre casas de 1 piso vs 2 pisos?

```{r}
# Escribe tu código aquí
```

## Parte 4: Series de Tiempo (Líneas)

### Ejercicio 4.1: Tendencia por Año de Construcción

Queremos ver si las casas más nuevas son más grandes.

1. Agrupa los datos por yr_built (Año de construcción).

2. Calcula el promedio de sqft_living para cada año.

3. Grafica esa tabla resumen: Año en X, Tamaño Promedio en Y.

4. Usa geom_line().

```{r}
# 1. Preparar datos (Resumen)

# 2. Graficar
```

## Parte 5: Personalización Final (Etiquetas y Tema)

### Ejercicio 5.1: Gráfico de Publicación

Toma cualquiera de los gráficos anteriores y hazlo lucir profesional:

1. Agrega un título descriptivo con labs(title = "...").

2. Cambia las etiquetas de los ejes X e Y (x = "...", y = "...").

3. Elimina la leyenda si es redundante o cámbiale el título (color = "Condición").

4. Aplica un tema limpio como theme_minimal() o theme_classic().

```{r}
# Escribe tu código aquí
```
