---
title: "Evaluaci贸n Integral: R para Ciencia de Datos"
subtitle: "Caso Pr谩ctico: Limpieza y An谩lisis de Ventas Nike"
author: "Oliver Trive帽o"
format: live-html
engine: knitr
editor: visual
lang: es
---

```{webr}
#| context: setup

# 1. Definimos la URL Raw
url_nike <- "https://raw.githubusercontent.com/Olivertc24/Notebook_R_Rstudio/refs/heads/main/prueba/Nike_Sales_Uncleaned.csv"
install.packages("tidyverse")

# 2. Descargamos el archivo al sistema virtual de WebR
download.file(url_nike, "Nike_Sales_Uncleaned.csv")

```

##  Objetivo de la Evaluaci贸n

Integrar los conocimientos de los M贸dulos 1 al 7 para transformar un dataset "sucio" en informaci贸n valiosa.

**Dataset:** `Nike_Sales_Uncleaned.csv`

**Desaf铆os detectados:**

-   Fechas en m煤ltiples formatos (YYYY-MM-DD, DD-MM-YYYY, YYYY/MM/DD).

-   Regiones escritas de forma inconsistente ("bengaluru", "Bangalore").

-   Datos faltantes (`NA`) en unidades vendidas.

-   Columnas num茅ricas que podr铆an leerse como texto.

------------------------------------------------------------------------

## 1. Importaci贸n e Inspecci贸n (M贸dulos 1, 4)

### Ejercicio 1.1: Carga Robusta

Carga los paquetes `tidyverse` y `lubridate` (para fechas).

Lee el archivo `Nike_Sales_Uncleaned.csv`.

*Pista:* Al leerlo, observa si la columna `Order_Date` se carg贸 como fecha o como texto.

```{webr}
#| message: false
# 1. Cargar librer铆as

# 2. Leer dataset

# 3. Inspecci贸n inicial (glimpse o str)
```

## 2. Limpieza de Datos "Wrangling" (M贸dulo 5)

### Ejercicio 2.1: Estandarizaci贸n de Texto

La columna Region es un desastre. Hay "bengaluru", "Bangalore", "Hyd", "Hyderabad".

1.  Usa mutate() para convertir toda la columna Region a T铆tulo (primera letra may煤scula) usando str_to_title().

2.  (Opcional/Reto) Usa case_when o str_replace para corregir "Hyd" a "Hyderabad" y "Bengaluru" a "Bangalore".

```{webr}
# Tu c贸digo aqu铆
```

### Ejercicio 2.2: Manejo de NAs

La columna Units_Sold tiene valores vac铆os (NA). Como actuario, decides ser conservador:

1.  Filtra y elimina las filas donde Units_Sold sea NA (no podemos inventar ventas).

2.  Verifica que ya no queden NAs en esa columna.

```{webr}
# Tu c贸digo aqu铆
```

### Ejercicio 2.3: El Infierno de las Fechas

La columna Order_Date tiene formatos mezclados (2024-03-09 vs 15-10-2023). Intenta usar la funci贸n parse_date_time() del paquete lubridate con el argumento orders = c("ymd", "dmy") para estandarizar todo a una fecha real.

```{webr}
# Tu c贸digo aqu铆
```

## 3. Manipulaci贸n y Estructuras (M贸dulos 2, 3, 5)

### Ejercicio 3.1: Creaci贸n de M茅tricas.

Crea una nueva columna llamada Margen_Pct (Porcentaje de Margen) calculada como:

$$Margen = \frac{Revenue - (MRP \times Units\_Sold)}{Revenue}$$

Nota: Si el Revenue es 0, esto dar谩 infinito. Filtra primero o acepta el riesgo.

```{webr}
# Tu c贸digo aqu铆
```

### Ejercicio 3.2: Agrupaci贸n

Queremos saber qu茅 categor铆a de g茅nero (Gender_Category) es m谩s rentable.

1.  Agrupa por Gender_Category.

2.  Calcula el Total_Revenue (suma) y el Promedio_Profit (media).

3.  Ordena de mayor a menor ingresos.

```{webr}
# Tu c贸digo aqu铆
```

## 4. Visualizaci贸n (M贸dulo 6)

### Ejercicio 4.1: Ventas por Canal

Crea un gr谩fico de barras (geom_col) que muestre el Total de Revenue por Sales_Channel.

-   Rellena las barras con un color corporativo (ej. "darkblue").

-   Agrega etiquetas de texto o t铆tulo.

```{webr}
# Tu c贸digo aqu铆
```

### Ejercicio 4.2: Serie de Tiempo (Tendencia)

Usa la columna de fecha limpia (del Ejercicio 2.3).

1.  Grafica la evoluci贸n del Revenue a lo largo del tiempo (geom_line o geom_smooth).

2.  Separa el gr谩fico en dos paneles (facetas) seg煤n Sales_Channel (Retail vs Online).

```{webr}
# Tu c贸digo aqu铆
```

## 5. Programaci贸n Funcional (M贸dulo 7)

### Ejercicio 5.1: Funci贸n de Clasificaci贸n

Crea una funci贸n personalizada llamada clasificar_rentabilidad que reciba un valor num茅rico (profit) y devuelva:

-   "P茅rdida" si es \< 0

-   "Baja" si est谩 entre 0 y 500

-   "Alta" si es \> 500

```{webr}
# Define tu funci贸n aqu铆
```

### Ejercicio 5.2: Aplicaci贸n Vectorizada

Aplica tu funci贸n a la columna Profit del dataset para crear una nueva variable categ贸rica Tipo_Rentabilidad. Usa mutate() junto con tu funci贸n (o map_chr si prefieres purrr). Cuenta cu谩ntas transacciones hay de cada tipo.

```{webr}
# Tu c贸digo aqu铆
```
