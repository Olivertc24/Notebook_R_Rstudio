---
title: "M√≥dulo 6: Visualizaci√≥n Avanzada"
subtitle: "La Gram√°tica de Gr√°ficos con ggplot2"
author: "Prof. Oliver Trive√±o"
format: 
  revealjs:
    theme: simple
    transition: slide
    slide-number: true
    logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/724px-R_logo.svg.png"
    footer: "Visualizaci√≥n con ggplot2"
    echo: true
    fig-width: 6
    fig-height: 4
editor: visual
lang: es
---

## La Filosof√≠a `ggplot2`

A diferencia de Excel, aqu√≠ no elegimos un "gr√°fico de la galer√≠a". Construimos el gr√°fico por **capas**, como si estuvi√©ramos pintando un cuadro.

La estructura b√°sica es: $$Gr√°fico = Datos + Est√©tica (aes) + Geometr√≠a (geom)$$

------------------------------------------------------------------------

## Preparando los Datos

Vamos a simular una cartera de seguros de Autom√≥vil para los ejemplos.

```{r}
#| message: false
library(tidyverse)

# Semilla para reproducibilidad
set.seed(123)

cartera <- tibble(
  edad = sample(18:70, 100, replace = TRUE),
  tipo_auto = sample(c("Sedan", "SUV", "Deportivo"), 100, replace = T),
  prima = jitter(edad * 10 + sample(200:500, 100)),
  siniestro = sample(c(0, 1), 100, replace = TRUE, prob = c(0.8, 0.2))
) %>% 
  mutate(siniestro = as.factor(siniestro))
```

## 1. Dispersi√≥n (Scatter Plot)

Relaci√≥n entre dos variables num√©ricas.

**OJO**: Usamos + para agregar capas, no %\>%.

::::: columns
::: {.column width="50%"}
```{r}
#| label: scatter
#| eval: false
ggplot(data = cartera, 
       aes(x = edad, 
           y = prima)) +
  geom_point(color = "blue", 
             size = 3)
```

-   Data: cartera
-   Aes: x=edad, y=prima
-   Geom: Puntos
:::

::: {.column width="50%"}
```{r}
#| label: scatter-out
#| echo: false
ggplot(data = cartera, aes(x = edad, y = prima)) +
  geom_point(color = "blue", size = 3) + theme_minimal()
```
:::
:::::

------------------------------------------------------------------------

## 2. Mapeo de Colores (Aesthetics)

¬øY si queremos que el color dependa de una variable (ej. Tipo de Auto)? Movemos color DENTRO de aes().

::::: columns
::: {.column width="45%"}
```{r}
#| label: aes-color
#| eval: false
ggplot(cartera, 
       aes(x = edad, 
           y = prima,
           color = tipo_auto)) +
  geom_point(size = 3)
```
:::

::: {.column width="55%"}
```{r}
#| label: aes-color-out
#| echo: false
ggplot(cartera, aes(x = edad, y = prima, color = tipo_auto)) +
  geom_point(size = 3) + theme_minimal(base_size = 14) + theme(legend.position="top")
```
:::
:::::

------------------------------------------------------------------------

## 3. Gr√°ficos de Distribuci√≥n

Vitales para actuarios: Histogramas y Boxplots.

Histograma (Variable Num√©rica)

::::: columns
::: {.column width="40%"}
```{r}
#| label: hist
#| eval: false
ggplot(cartera, 
       aes(x = prima)) +
  geom_histogram(
    bins = 15,
    fill = "skyblue",
    color = "black"
  )
```
:::

::: {.column width="60%"}
```{r}
#| label: hist-out
#| echo: false
ggplot(cartera, aes(x = prima)) +
  geom_histogram(bins = 15, fill = "skyblue", color = "black") + theme_minimal()
```
:::
:::::

------------------------------------------------------------------------

## Boxplot (Num√©rica vs Categ√≥rica)

Para ver dispersi√≥n y outliers por grupo.

::::: columns
::: {.column width="40%"}
```{r}
#| label: box
#| eval: false
ggplot(cartera, 
       aes(x = tipo_auto, 
           y = prima,
           fill = tipo_auto)) +
  geom_boxplot()
```
:::

::: {.column width="60%"}
```{r}
#| label: box-out
#| echo: false
ggplot(cartera, 
       aes(x = tipo_auto, 
           y = prima,
           fill = tipo_auto)) +
  geom_boxplot()
```
:::
:::::

<div style="position: fixed; bottom: 30px; right: 30px; z-index: 1000;">
  <a href="../index.qmd" class="btn btn-primary shadow-lg" role="button" style="border-radius: 50px; padding: 10px 20px;">
    üè† Inicio
  </a>
</div>